<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒŸ åæ–‡å…¨è‡ªåŠ¨è¯†å­—é—¯å…³ ğŸŒŸ</title>

<style>
/* ç³–æœè‰²åŠ¨æ€èƒŒæ™¯ */
body {
    text-align: center;
    font-family: "Microsoft YaHei", "SimHei", sans-serif;
    background: linear-gradient(135deg, #FFDEE9 0%, #B5FFFC 100%);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

@keyframes gradientBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* å¥¶æ²¹é£æ¸¸æˆå¡ç‰‡ */
.card {
    background: rgba(255, 255, 255, 0.95);
    width: 90%;
    max-width: 550px;
    padding: 30px;
    border-radius: 50px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    border: 10px solid #FFFFFF;
}

h2 {
    color: #FF7E5F;
    font-size: 30px;
    margin-bottom: 20px;
    text-shadow: 2px 2px 0px #FFEBB7;
}

/* è¯è¯­å±•ç¤ºåŒº */
#word {
    font-size: 100px;
    margin: 15px 0;
    color: #333;
    font-weight: bold;
    text-shadow: 4px 4px 0px #FFD1D1;
    min-height: 130px;
    display: flex;
    justify-content: center;
    align-items: center;
}

#pinyin {
    font-size: 36px;
    color: #48C6EF;
    font-weight: bold;
    min-height: 45px;
    margin-bottom: 10px;
}

/* çŠ¶æ€æç¤ºä¸æ³¢æµªåŠ¨ç”» */
#status {
    font-size: 18px;
    color: #777;
    background: #F0F8FF;
    padding: 10px 20px;
    border-radius: 30px;
    margin-bottom: 15px;
    display: inline-block;
}

.mic-wave {
    display: inline-block;
    width: 10px;
    height: 10px;
    background-color: #ff7675;
    border-radius: 50%;
    margin-right: 8px;
    animation: wave 1s infinite;
}

@keyframes wave {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.5; }
    100% { transform: scale(1); opacity: 1; }
}

/* æŒ‰é’®æ ·å¼ */
button {
    padding: 15px 35px;
    font-size: 20px;
    margin: 10px;
    border: none;
    border-radius: 40px;
    cursor: pointer;
    font-weight: bold;
    color: white;
    transition: all 0.2s;
    box-shadow: 0 6px 0px #CCC;
}

button:active { transform: translateY(4px); box-shadow: 0 2px 0px #CCC; }

#initBtn { background-color: #4facfe; box-shadow: 0 8px 0px #0072ff; }
#nextBtn { background-color: #667eea; box-shadow: 0 8px 0px #764ba2; }
#hintBtn { background-color: #f6d365; box-shadow: 0 8px 0px #fda085; color: #666; }

/* å¥–åŠ±åŠ¨ç”»æ•ˆæœ */
.reward {
    margin-top: 10px;
    animation: pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes pop {
    0% { transform: scale(0.5); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

.reward-image {
    width: 80px;
    height: auto;
    margin: 10px auto;
}

.watermark {
    position: fixed;
    bottom: 20px;
    right: 20px;
    font-size: 14px;
    color: #FF6B6B;
    background: rgba(255,255,255,0.6);
    padding: 5px 12px;
    border-radius: 20px;
}
</style>
</head>

<body>

<div class="card">
    <h2>ğŸ¦ åæ–‡è¯†å­—å¤§é—¯å…³ ğŸ¦</h2>

    <div id="init-screen">
        <p style="font-size: 20px; color: #777;">å‡†å¤‡å¥½äº†å—ï¼Ÿå°æœ‹å‹ï¼</p>
        <button onclick="initGame()" id="initBtn">ğŸ§ å¼€å¯éº¦å…‹é£å¹¶å¼€å§‹</button>
    </div>

    <div id="game-screen" style="display:none;">
        <div id="status">æ­£åœ¨å‡†å¤‡ä¸­...</div>
        <div id="pinyin"></div>
        <div id="word"></div>
        <div id="reward"></div>
        
        <div style="margin-top: 15px;">
            <button onclick="showHint()" id="hintBtn">ğŸ’¡ æ‹¼éŸ³æç¤º</button>
            <button onclick="nextWord()" id="nextBtn" style="display:none;">ä¸‹ä¸€å…³ âœ</button>
        </div>
    </div>
</div>

<div class="watermark">ğŸ« å¸¸è€å¸ˆåæ–‡è¯¾å ‚</div>

<script>
const words = [
    {han:"å°é¸Ÿ", py:"xiÇo niÇo"}, {han:"ç«¹å­", py:"zhÃº zi"},
    {han:"å¤§è±¡", py:"dÃ  xiÃ ng"}, {han:"çˆ·çˆ·", py:"yÃ© ye"},
    {han:"å§å§", py:"jiÄ› jie"}, {han:"ç”·äºº", py:"nÃ¡n rÃ©n"},
    {han:"å¤§å®¶", py:"dÃ  jiÄ"}, {han:"ä¸Šæ¥", py:"shÃ ng lÃ¡i"},
    {han:"ä¸‹å»", py:"xiÃ  qÃ¹"}, {han:"ç¬‘äº†", py:"xiÃ o le"},
    {han:"å“­äº†", py:"kÅ« le"}, {han:"ç”°é‡Œ", py:"tiÃ¡n lÇ"},
    {han:"ç½‘é‡Œ", py:"wÇng lÇ"}, {han:"å°åˆ€", py:"xiÇo dÄo"},
    {han:"å°è‹—", py:"xiÇo miÃ¡o"}
];

// å›¾åƒå¥–åŠ±èµ„æº
const rewardImages = [
    "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjRkZEMzVEIiBkPSJNMzIwIDEyOGgtNjRsLTMyLTMyVjY0YTY0IDY0IDAgMCAwLTEyOCAwdjI1NmEyNTYgMjU2IDAgMCAwIDI1NiAyNTZoMTI4YTY0IDY0IDAgMCAwIDY0LTY0VjE5MmE2NCA2NCAwIHMwLTAgNjQtNjRoLTY0ek0xOTIgOTZ2MzJoMzJMNjQgMzIweiIvPjxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik0zODQgMTkySDI1NmMtMTcuNyAwLTMyLTE0LjMtMzItMzJWOTZsLTMyLTMyaC05NnYyNTZjMCAxNDEuNCAxMTQuNiAyNTYgMjU2IDI1NmgxMjhjMzUuMyAwIDY0LTI4LjcgNjQtNjRWMTkyek0zNTIgMTkySDI4OHY2NGg2NHpNMzIwIDY0djY0aC02NFY2NHo5NiAxMjhWMjU2SDI4OHYtNjR6Ii8+PHBhdGggZmlsbD0iI0ZGQzEwNyIgZD0iTTE2MCA2NHYyNTZjMCAxMDYgODYgMTkyIDE5MiAxOTJoMTI4YzE3LjcgMCAzMi0xNC4zIDMyLTMyVjE5MmMwLTE3LjctMTQuMy0zMi0zMi0zMkgzODRsLTMyLTMyVjY0YzAtMzUuMy0yOC43LTY0LTY0LTY0cy02NCAyOC43LTY0IDY0ek0yNTYgMTkySDMyVjY0ek0zODQgMjU2SDI4OHYtNjRoOTZ6TTMyMCA2NHY2NGgtNjRWNjR6Ii8+PC9zdmc+", // èµ
    "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjRkZEMzVEIiBkPSJNMjU2IDBsNzYuNSAxNzQuNEw1MTIgMjA4bC0xMjguNSAxMjAuNkw0MTYgNTEybC0xNjAtOTkuMi0xNjAgOTkuMiAzMi41LTE4My40TDAgMjA4bDE3OS41LTMzLjZ6Ii8+PHBhdGggZmlsbD0iI0ZGRkZGRiIgZD0iTTI1NiA5NmwtNDQuNCA4NS44TDEyOCA5NmwxMzIuNiA4NC45TDMyMCA5NnoiLz48cGF0aCBmaWxsPSIjRkZDMTEwIiBkPSJNMjU2IDB2NDA3LjJsMTYwIDk5LjItMzIuNS0xODMuNEw1MTIgMjA4bC0xNzkuNS0zMy42ek0zMjAgOTZ2MzJMNjQgMzIweiIvPjwvc3ZnPg==", // æ˜Ÿæ˜Ÿ
    "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48Y2lyY2xlIGN4PSI4MCIgY3k9IjgwIiByPSIyMCIgZmlsbD0iI0ZGRDZGRCIvPjxjaXJjbGUgY3g9IjQwMCIgY3k9IjgwIiByPSIyMCIgZmlsbD0iIzQwRTRGRCIvPjxjaXJjbGUgY3g9IjgwIiBjeT0iNDAwIiByPSIyMCIgZmlsbD0iIzREOEZGRCIvPjxjaXJjbGUgY3g9IjQwMCIgY3k9IjQwMCIgcjPSIyMCIgZmlsbD0iI0ZGRTgzRCIvPjxwYXRoIGZpbGw9IiNGRjg5OEIiIGQ9Ik0xNjAgMjQwdi00MGwtMjAgMjBtNDAgMEwxNjAgMjQwek0zNTIgMjQwbC0yMC0yMG00MCAwTDM1MiAyNDB6Ii8+PHBhdGggZmlsbD0iIzgwREU5QiIgZD0iTTEyOCAzNTJsMjAgMjB2LTQwek0zNjQgMzcybDIwLTIwaC00MHpNMjQwIDE2MGgtMjBsMjAgMjB6TTI4MCAxOTJsMjAgMjB2LTQwek0yMjAgMzAwaDIwdi00MHpNMzAwIDM0MGwtMjAtMjBoNDB6Ii8+PC9zdmc+" // æ’’èŠ±
];

let index = 0;
let recognition;

async function initGame() {
    try {
        await navigator.mediaDevices.getUserMedia({ audio: true });
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            alert("è¯·ä½¿ç”¨ Chrome æµè§ˆå™¨æ‰“å¼€ä»¥è·å¾—æœ€ä½³ä½“éªŒï¼");
            return;
        }
        recognition = new SpeechRecognition();
        recognition.lang = "zh-CN";
        recognition.continuous = false;

        recognition.onresult = (event) => {
            let result = event.results[0][0].transcript.replace(/\s/g, "");
            checkResult(result);
        };

        recognition.onerror = () => {
            if(index < words.length && document.getElementById("nextBtn").style.display === "none") {
                recognition.start();
            }
        };

        document.getElementById("init-screen").style.display = "none";
        document.getElementById("game-screen").style.display = "block";
        showWord();
    } catch (err) {
        alert("è¯·æˆæƒéº¦å…‹é£æƒé™ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«è¯­éŸ³å“¦ï¼");
    }
}

function showWord() {
    if (index >= words.length) {
        finishGame();
        return;
    }
    document.getElementById("word").innerText = words[index].han;
    document.getElementById("pinyin").innerText = "";
    document.getElementById("reward").innerHTML = "";
    document.getElementById("status").innerHTML = '<span class="mic-wave"></span>è¯·è¯»å‡ºè¿™ä¸ªè¯è¯­...';
    document.getElementById("nextBtn").style.display = "none";
    document.getElementById("hintBtn").style.display = "inline-block";
    recognition.start();
}

function checkResult(speech) {
    if (speech.includes(words[index].han)) {
        success();
    } else {
        document.getElementById("status").innerHTML = `å†è¯•ä¸€æ¬¡å§ï¼(å¬åˆ°: ${speech})`;
        setTimeout(() => {
            if(document.getElementById("nextBtn").style.display === "none") recognition.start();
        }, 1000);
    }
}

function success() {
    document.getElementById("pinyin").innerText = words[index].py;
    document.getElementById("status").innerHTML = "ğŸ‰ è¯»å¯¹å•¦ï¼";
    
    // 1. è·å–éšæœºå¥–åŠ±å›¾
    const randomImg = rewardImages[Math.floor(Math.random() * rewardImages.length)];
    
    // 2. æ’å…¥ä¿®æ”¹åçš„ï¼šå½©è™¹è‰²ã€è°ƒå°çš„â€œå¤ªæ£’äº†â€æ–‡å­— + å›¾ç‰‡
    document.getElementById("reward").innerHTML = `
        <div class="reward" style="font-size: 28px; background: linear-gradient(to right, #ff4757, #ffa502, #2ed573, #1e90ff); -webkit-background-clip: text; color: transparent; font-weight: bold; margin-bottom: 5px;">
            â­ å¤ªæ£’äº† â­
        </div>
        <img src="${randomImg}" class="reward-image">
    `;
    
    document.getElementById("nextBtn").style.display = "inline-block";
    document.getElementById("hintBtn").style.display = "none";
}

function nextWord() {
    index++;
    showWord();
}

function showHint() {
    document.getElementById("pinyin").innerText = words[index].py;
}

function finishGame() {
    document.getElementById("word").innerHTML = "ğŸ†";
    document.getElementById("pinyin").innerText = "";
    document.getElementById("status").innerHTML = "å…¨é€šå…³å•¦ï¼ä½ æ˜¯è¯†å­—å°çŠ¶å…ƒï¼";
    document.getElementById("reward").innerHTML = "<div style='font-size:50px'>ğŸŠğŸ‘‘ğŸŠ</div>";
    document.getElementById("nextBtn").style.display = "none";
}
</script>

</body>
</html>